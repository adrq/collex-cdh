jQuery(document).ready(function(e){"use strict";var a=e("body"),t=e("#add-search-constraint");t.on("submit",function(){var n=e(".add_constraint_form").is(":visible");if(!n)return!1;var r=t.find('input[type="submit"]'),i=r.val();r.each(function(e,a){a.disabled=!0,a.value="......",a.addClassName("submitting")});var s=function(){r.each(function(e,a){a.disabled=!1,a.value=i,a.removeClassName("submitting")})},l=function(e){new MessageBoxDlg("Error",e),s()},c=t.find('input[type="text"],select[class="search_language"]'),u={},o=!1;c.each(function(a,t){e(t).val().length>0&&(o=!0,u[t.name]=e(t).val())});var d=t.find('select[class="search_role_type"]');if(d.length>0){var f=u.search_role,v=d.val();f&&v&&v.length>0&&(u[v]=f),delete u.search_role}var h=e("input:radio[name=fuz_q]:checked");h&&(u.fuz_q=h.val());var g=e("input:radio[name=fuz_t]:checked");if(g&&(u.fuz_t=g.val()),!o)return l("Please enter some text before searching."),!1;var m=u.y;if(m&&m.length>0)if(m=window.collex.formatYearString(m),m.length>0){var y=/^\d{4}(\s+TO\s+\d{4})?$/;if(!y.match(m))return l("The year must be 4 digits or a valid year span (e.g. 1700 TO 1900)."),!1;u.y=m}else delete u.y;return a.trigger("SetSearch",u),setTimeout(function(){c.val(""),s()},2e3),!1})});