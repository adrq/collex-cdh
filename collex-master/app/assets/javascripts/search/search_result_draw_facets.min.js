jQuery(document).ready(function(e){"use strict";function t(e,t,a,l,i,o){if(i||(i=e),l){var n=window.collex.create_facet_button("[X]",e,"remove",a);return window.pss.createHtmlTag("tr",{"class":o},window.pss.createHtmlTag("td",{"class":"limit_to_lvl1"},i+"&nbsp;&nbsp;"+n)+window.pss.createHtmlTag("td",{"class":"num_objects"},window.collex.number_with_delimiter(t)))}var c=window.collex.create_facet_button(i,e,"add",a);return window.pss.createHtmlTag("tr",{"class":o},window.pss.createHtmlTag("td",{"class":"limit_to_lvl1"},c)+window.pss.createHtmlTag("td",{"class":"num_objects"},window.collex.number_with_delimiter(t)))}function a(a,l,i,o,n,c){var r="";"string"==typeof o&&(o=[o]);for(var s in l)if(l.hasOwnProperty(s)){var d=e.inArray(s,o),w=s;n&&(w=n[s]),r+=t(s,l[s],i,-1!==d,w,c)}var _=e("."+a),g=window.pss.createHtmlTag("tr",{},_.find("tr:first-of-type").html());_.html(g+r)}function l(e,t,a,l,i){var o=window.pss.createHtmlTag("button",{"class":"nav_link  limit_to_arrow","data-action":"open"},window.pss.createHtmlTag("img",{alt:"Arrow Open",src:window.collex.images.arrow_open})),n=window.pss.createHtmlTag("button",{"class":"nav_link  limit_to_arrow","data-action":"close"},window.pss.createHtmlTag("img",{alt:"Arrow Close",src:window.collex.images.arrow_close})),c=window.pss.createHtmlTag("button",{"class":"nav_link limit_to_category","data-action":"toggle"},a),r=window.pss.createHtmlTag("td",{"class":"resource-tree-node limit_to_lvl"+t,"data-id":e},o+n+c),s=window.pss.createHtmlTag("td",{"class":"num_objects"},window.collex.number_with_delimiter(l)),d="resource_node "+i;return window.pss.createHtmlTag("tr",{id:"resource_"+e,"class":d},r+s)}function i(e,t,a,l,i,o,n){var c,r=o;n?(r+=" limit_to_selected",c=window.pss.createHtmlTag("td",{"class":"limit_to_lvl"+t},a+"&nbsp;&nbsp;"+window.collex.create_facet_button("[X]",i,"remove","a"))):c=window.pss.createHtmlTag("td",{"class":"limit_to_lvl"+t},window.collex.create_facet_button(a,i,"replace","a"));var s=window.pss.createHtmlTag("td",{"class":"num_objects"},window.collex.number_with_delimiter(l));return window.pss.createHtmlTag("tr",{id:"resource_"+e,"class":r},c+s)}function o(e,t,a,n,c){for(var r="",s=0,d=0;d<e.length;d++){var w=e[d];if(w.children){var _=o(w.children,t,a+1,"child_of_"+w.id,c);if(s+=_.total,_.total>0){var g=l(w.id,a,w.name,window.collex.number_with_delimiter(_.total),n);r+=g+_.html}}else t[w.handle]&&(r+=i(w.id,a,w.name,t[w.handle],w.handle,n,w.handle===c),s+=parseInt(t[w.handle],10))}return{html:r,total:s}}function n(e,t){for(var a=e.find(".resource_node.child_of_"+t),l=0;l<a.length;l++){var i=a[l],o=i.id.split("_")[1];e.find(".child_of_"+o).hide(),n(e,o)}}function c(t,a){var l=o(window.collex.facetNames.archives,t,1,"",a).html,i=e(".facet-archive"),n=window.pss.createHtmlTag("tr",{},i.find("tr:first-of-type").html());i.html(n+l),window.collex.setResourceToggle(i,window.collex.facetNames.archives)}window.collex.create_facet_button=function(e,t,a,l){return window.pss.createHtmlTag("button",{"class":"select-facet nav_link","data-action":a,"data-key":l,"data-value":t},e)},window.collex.number_with_delimiter=function(e){var t=",",a=".",l=(""+e).split(".");return l[0]=l[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+t),l.join(a)},window.collex.setResourceToggle=function(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.children&&("open"===l.toggle?e.find("#resource_"+l.id+' button[data-action="open"]').hide():(e.find("#resource_"+l.id+' button[data-action="close"]').hide(),e.find(".child_of_"+l.id).hide(),n(e,l.id)),window.collex.setResourceToggle(e,l.children))}};var r,s,d,w,_,g,f,m;window.collex.createFacets=function(e,t){if(1==window.collex.access_value){a("facet-access",e.facets.access,"o",e.query.o,window.collex.facetNames.access,"access"),c(e.facets.archive,e.query.a),r=document.getElementsByClassName("access");for(var l=0;l<r.length;l++)t%2!=0?r[l].style.display="block":r[l].style.display="none"}else if(1==window.collex.genre_value){a("facet-genre",e.facets.genre,"g",e.query.g,"genre","genre"),c(e.facets.archive,e.query.a),s=document.getElementsByClassName("genre");for(var l=0;l<s.length;l++)t%2!=0?s[l].style.display="block":s[l].style.display="none"}else if(1==window.collex.origin_value){a("facet-origin",e.facets.origin,"origin",e.query.origin,"origin","origin"),c(e.facets.archive,e.query.a),d=document.getElementsByClassName("origin");for(var l=0;l<d.length;l++)t%2!=0?d[l].style.display="block":d[l].style.display="none"}else if(1==window.collex.composition_value){a("facet-composition",e.facets.composition,"composition",e.query.composition,"composition","composition"),c(e.facets.archive,e.query.a),_=document.getElementsByClassName("composition");for(var l=0;l<_.length;l++)t%2!=0?_[l].style.display="block":_[l].style.display="none"}else if(1==window.collex.provenance_value){a("facet-provenance",e.facets.provenance,"provenance",e.query.provenance,"provenance","provenance"),c(e.facets.archive,e.query.a),g=document.getElementsByClassName("provenance");for(var l=0;l<g.length;l++)t%2!=0?g[l].style.display="block":g[l].style.display="none"}else if(1==window.collex.language_value){a("facet-language",e.facets.language,"lang",e.query.lang,"language","language"),c(e.facets.archive,e.query.a),w=document.getElementsByClassName("language");for(var l=0;l<w.length;l++)t%2!=0?w[l].style.display="block":w[l].style.display="none"}else if(1==window.collex.type_original_artifact_value){a("facet-type_original_artifact",e.facets.type_original_artifact,"type_original_artifact",e.query.type_original_artifact,"type_original_artifact","type_original_artifact"),c(e.facets.archive,e.query.a),m=document.getElementsByClassName("type_original_artifact");for(var l=0;l<m.length;l++)t%2!=0?m[l].style.display="block":m[l].style.display="none"}else if(1==window.collex.type_digital_artifact_value){a("facet-type_digital_artifact",e.facets.type_digital_artifact,"type_digital_artifact",e.query.type_digital_artifact,"type_digital_artifact","type_digital_artifact"),c(e.facets.archive,e.query.a),f=document.getElementsByClassName("type_digital_artifact");for(var l=0;l<f.length;l++)t%2!=0?f[l].style.display="block":f[l].style.display="none"}}});